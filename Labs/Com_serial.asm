#include registers.inc

;*******************************************************************************
;                             Estructuras de datos
;*******************************************************************************
EOM                        EQU $FF
                                org $1000
Puntero                    ds 2
msg              fcc "Bryan"
                 db EOM

SC1_vec                 equ $3E54

;*******************************************************************************
;                 Reubicar el vector de Interrupciones
;*******************************************************************************
                             org SC1_vec
                        dw  SC1_ISR

;*******************************************************************************
;                             Configuracion del Hardware
;*******************************************************************************
                              org $2000
                        movw #39,SC1BDH
                        movb #$00,SC1CR1
                        movb #$88,SC1CR2
                        
                        ldaa SC1SR1
                        movb #$00,SC1DRL
                        

;*******************************************************************************
;                          Programa Principal
;*******************************************************************************
                        lds #$3BFF
                        cli
                        ldx #msg
                        stx Puntero

                        ldaa SC1SR1
                        movb #$0C,SC1DRL

                        bra *
;*******************************************************************************
;                     Interrupcion SC1
;*******************************************************************************

SC1_ISR
                      ldaa SC1SR1
                      ldx Puntero
                      ldaa 1,x+
                      cmpa #EOM
                      beq Borrar_TE
                      staa SC1DRL
                      stx Puntero
                      bra fin_SC1
Borrar_TE             bclr SC1CR2,$08

fin_SC1               rti